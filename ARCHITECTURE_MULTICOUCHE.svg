<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="2200" height="1500" viewBox="0 0 2200 1500">
  <defs>
    <linearGradient id="bgGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#f8fafc"/>
      <stop offset="100%" stop-color="#eef2f7"/>
    </linearGradient>
    <style>
      .title { font: 700 46px 'Segoe UI', Arial, sans-serif; fill: #0f172a; }
      .subtitle { font: 600 26px 'Segoe UI', Arial, sans-serif; fill: #334155; }
      .label { font: 500 22px 'Segoe UI', Arial, sans-serif; fill: #0f172a; }
      .small { font: 400 18px 'Segoe UI', Arial, sans-serif; fill: #1f2937; }
      .tiny { font: 400 16px 'Segoe UI', Arial, sans-serif; fill: #374151; }
      .box { rx: 18; ry: 18; stroke-width: 2.5; }
      .arrow { stroke: #0ea5e9; stroke-width: 4; marker-end: url(#arrowHead); fill: none; }
      .divider { stroke: #cbd5e1; stroke-width: 2; stroke-dasharray: 6 8; }
    </style>
    <marker id="arrowHead" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#0ea5e9"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect x="0" y="0" width="2200" height="1500" fill="url(#bgGrad)"/>

  <!-- Header -->
  <text x="1100" y="80" text-anchor="middle" class="title">Architecture Multicouche du Système de Réservation IA</text>
  <text x="1100" y="120" text-anchor="middle" class="subtitle">React (Frontend) • Spring Boot (Backend) • JWT • JPA • OpenAI • Analytics</text>

  <!-- Layer containers -->
  <!-- 1. Presentation Layer -->
  <rect class="box" x="120" y="180" width="1960" height="160" fill="#e0f2fe" stroke="#38bdf8"/>
  <text x="140" y="220" class="subtitle">1) Couche Présentation (Frontend)</text>
  <text x="140" y="260" class="small">React + React Router, Context: Auth/Theme, Axios (interceptors)</text>
  <text x="140" y="300" class="tiny">Composants: Dashboard, Analytics, AI Recommendations, CRUD Workstations</text>
  <!-- Frontend inner boxes -->
  <rect class="box" x="1380" y="210" width="680" height="110" fill="#ffffff" stroke="#93c5fd"/>
  <text x="1410" y="250" class="label">Services API (axios)</text>
  <text x="1410" y="285" class="tiny">/auth, /reservations, /analytics, /ai, /workstations</text>

  <!-- 2. API & Controllers Layer -->
  <rect class="box" x="120" y="370" width="1960" height="170" fill="#dcfce7" stroke="#34d399"/>
  <text x="140" y="410" class="subtitle">2) Couche API • Contrôleurs REST (Spring Boot)</text>
  <text x="140" y="450" class="small">Controllers: AuthController, ReservationController, WorkStationController, AnalyticsController, AiRecommendationController</text>
  <text x="140" y="485" class="tiny">Validation DTO, mapping Request/Response, @PreAuthorize selon rôles</text>

  <!-- 3. Security Layer -->
  <rect class="box" x="120" y="570" width="1960" height="170" fill="#fee2e2" stroke="#f87171"/>
  <text x="140" y="610" class="subtitle">3) Couche Sécurité • JWT &amp; RBAC</text>
  <text x="140" y="650" class="small">SecurityConfig (stateless, CORS), JwtAuthFilter, JwtUtils (claims: id, email, role)</text>
  <text x="140" y="685" class="tiny">Rôles: STUDENT, CENTER_MANAGER, PEDAGOGICAL_MANAGER, ASSET_MANAGER, EXECUTIVE_DIRECTOR, ADMIN</text>

  <!-- 4. Service / Domaine Layer -->
  <rect class="box" x="120" y="770" width="1960" height="210" fill="#fde68a" stroke="#f59e0b"/>
  <text x="140" y="810" class="subtitle">4) Couche Service &amp; Métier</text>
  <text x="140" y="850" class="small">Services: ReservationService, WorkStationService, AnalyticsService, AiRecommendationService</text>
  <text x="140" y="885" class="tiny">Règles: 1 réservation active/étudiant, durée max 2h, cooldown, chevauchements, statuts</text>

  <!-- Service inner boxes -->
  <rect class="box" x="132" y="820" width="540" height="120" fill="#fff7ed" stroke="#f59e0b"/>
  <text x="160" y="860" class="label">ReservationService</text>
  <text x="160" y="895" class="tiny">Validation utilisateur/poste, durée, disponibilité, statut</text>

  <rect class="box" x="702" y="820" width="540" height="120" fill="#fff7ed" stroke="#f59e0b"/>
  <text x="730" y="860" class="label">AnalyticsService</text>
  <text x="730" y="895" class="tiny">Tendances, usages postes, comparaisons centres, top users</text>

  <rect class="box" x="1272" y="820" width="540" height="120" fill="#fff7ed" stroke="#f59e0b"/>
  <text x="1300" y="860" class="label">AiRecommendationService</text>
  <text x="1300" y="895" class="tiny">Profil utilisateur, postes disponibles, contexte centre, prompt OpenAI</text>

  <!-- 5. Intégrations Layer -->
  <rect class="box" x="120" y="1000" width="1960" height="170" fill="#e9d5ff" stroke="#a78bfa"/>
  <text x="140" y="1040" class="subtitle">5) Couche Intégrations</text>
  <text x="140" y="1080" class="small">OpenAI (RestTemplate), Email/Notifications, Exports Analytics, CORS/WebConfig, Static uploads</text>

  <!-- Integration inner boxes -->
  <rect class="box" x="132" y="1060" width="540" height="90" fill="#ffffff" stroke="#a78bfa"/>
  <text x="160" y="1100" class="label">OpenAI</text>
  <text x="160" y="1130" class="tiny">Clé/API URL, prompts, parsing réponses</text>

  <rect class="box" x="702" y="1060" width="540" height="90" fill="#ffffff" stroke="#a78bfa"/>
  <text x="730" y="1100" class="label">Uploads d'images</text>
  <text x="730" y="1130" class="tiny">/workstations/upload-image → /uploads/workstations/**</text>

  <rect class="box" x="1272" y="1060" width="540" height="90" fill="#ffffff" stroke="#a78bfa"/>
  <text x="1300" y="1100" class="label">CORS/Static</text>
  <text x="1300" y="1130" class="tiny">WebConfig: CORS localhost:5173, resources handler</text>

  <!-- 6. Persistence Layer -->
  <rect class="box" x="120" y="1190" width="1960" height="190" fill="#c7d2fe" stroke="#6366f1"/>
  <text x="140" y="1230" class="subtitle">6) Couche Persistance</text>
  <text x="140" y="1270" class="small">Repositories JPA: User, Reservation, WorkStation, Center, Maintenance, Notification</text>
  <text x="140" y="1305" class="tiny">DB relationnelle (Flyway migrations), mapping entités, statuts</text>

  <!-- Arrows between layers -->
  <line class="arrow" x1="1100" y1="340" x2="1100" y2="370"/>
  <line class="arrow" x1="1100" y1="540" x2="1100" y2="570"/>
  <line class="arrow" x1="1100" y1="740" x2="1100" y2="770"/>
  <line class="arrow" x1="1100" y1="980" x2="1100" y2="1000"/>
  <line class="arrow" x1="1100" y1="1170" x2="1100" y2="1190"/>

  <!-- External systems icons (simple) -->
  <g>
    <rect class="box" x="1770" y="210" width="300" height="110" fill="#ffffff" stroke="#93c5fd"/>
    <text x="1788" y="250" class="label">AuthContext / JWT</text>
    <text x="1788" y="285" class="tiny">Stockage token, redirections 401</text>
  </g>

  <!-- Notes -->
  <line x1="120" y1="154" x2="2080" y2="154" class="divider"/>
  <text x="1100" y="1470" text-anchor="middle" class="tiny">WEB4JOBS • EMSI MIAGE — Système intelligent de gestion des réservations • 2025</text>
</svg> 